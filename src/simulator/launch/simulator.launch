<launch>

  
  <arg name="type_a3d" default="false"/>
  <arg name="world_name" default="w1"/>
   <!-- <arg name="world_name" default="matterport"/> -->
  <arg name="gazebo_gui" default="true"/>
  
   
  <arg name="sensorOffsetX" default="0"/>
  <arg name="sensorOffsetY" default="0"/>

  <arg name="obstacle_num" default="2"/>
  <arg name="ped_start_index" default="0"/>
  <arg name="scene_start_index" default="0"/>
  <arg name="obstacle_radius" default="0.25"/>
  <arg name="delta_time" default="0.5"/>
  <arg name="pre_time" default="6"/>
  <arg name="v_mean" default="1"/>
  <arg name="robot_r" default="0.4"/>
  <arg name="safe_dis_global" default="0.3"/>


  <arg name="safe_dis_cbf" default="0"/>

 <!-- this robot_world.launch only contains robot_like obstacles    -->
  <include file="$(find simulator)/launch/robot_world.launch" >
    <arg name="world_name" value="$(arg world_name)"/>
    <arg name="gui" value="$(arg gazebo_gui)"/>
    <arg name="obstacle_num" value="$(arg obstacle_num)"/>
  </include>
  <include file="$(find scout_gazebo_sim)/launch/spawn_scout_v2.launch">
    <arg name="x" value="-6"/>
    <arg name="y" value="6"/>
    <arg name="z" value="1"/>
    <arg name="yaw" value="1.57"/>
  </include>

   <!--  simulate slam     -->
  <include file="$(find robot_simulator)/launch/scan_ref_sim.launch" >
    <arg name="sensorOffsetX" value="$(arg sensorOffsetX)" />
    <arg name="sensorOffsetY" value="$(arg sensorOffsetY)" />
   
  </include>
 


   
  <!-- <include file="$(find map)/launch/mapping.launch" >
    <arg name="sensorOffsetX" value="$(arg sensorOffsetX)" />
    <arg name="sensorOffsetY" value="$(arg sensorOffsetY)" />
  </include> -->


  <!-- <include file="$(find octomap)/launch/octomap_process.launch" >
  </include> -->

   <!-- <node name="ssc_pred" pkg="ssc_map" type="ssc_pred_online.py"  output="screen" required="true">
    <param name="obstacle_num"           value="$(arg obstacle_num)"/>
    <param name="ped_start_index"           value="$(arg ped_start_index)"/>
    <param name="scene_start_index"           value="$(arg scene_start_index)"/>
    <param name="obstacle_radius"           value="$(arg obstacle_radius)"/>
    <param name="delta_time"           value="$(arg delta_time)"/>
  </node> -->

  
<include file="$(find waypoint_generator)/launch/waypoint_generator.launch" >
</include>

<arg name="sampletime" default="0.25"/>
<arg name="interpolation_num" default="5"/>
<arg name="goal_dis" default="0.5"/>

<arg name="lowerbound_x" default="-16"/>
<arg name="lowerbound_y" default="-16"/>
<arg name="upperbound_x" default="16"/>
<arg name="upperbound_y" default="16"/>
<arg name="iter_max_g" default="2000000"/>
<arg name="max_subgoal_num" default="20000000"/>


<node name="global_planning" pkg="global_planner" type="global_planning" output="screen" required="true">
    <param name="/type_a3d"           value="$(arg type_a3d)"/>
    <param name="/obstacle_num"           value="$(arg obstacle_num)"/>
    <param name="/pre_time"           value="$(arg pre_time)"/>
    <param name="/delta_time"           value="$(arg delta_time)"/>
    <param name="/v_mean"           value="$(arg v_mean)"/>
    <param name="/sampletime"           value="$(arg sampletime)"/>
    <param name="/interpolation_num"           value="$(arg interpolation_num)"/>
    <param name="/goal_dis"           value="$(arg goal_dis)"/>

    <param name="/robot_r"           value="$(arg robot_r)"/>
    <param name="/safe_dis"           value="$(arg safe_dis_global)"/>


    <param name="/lowerbound_x"           value="$(arg lowerbound_x)"/>
    <param name="/lowerbound_y"           value="$(arg lowerbound_y)"/>
    <param name="/upperbound_x"           value="$(arg upperbound_x)"/>
    <param name="/upperbound_y"           value="$(arg upperbound_y)"/>
    <param name="/iter_max_g"           value="$(arg iter_max_g)"/>
    <param name="/max_subgoal_num"           value="$(arg max_subgoal_num)"/>


    <!-- <param name="/max_subgoal_num"           value="10"/> -->
  </node>






<group if  ="$(arg type_a3d)"> 
  <node name="local_planner" pkg="local_planner" type="local_planner_a3d.py" launch-prefix="gnome-terminal --title=a3d_local -x">
    <param name="/obstacle_num"           value="$(arg obstacle_num)"/>
  </node>
</group>  

<group unless="$(arg type_a3d)"> 
  <node name="local_planner" pkg="local_planner" type="local_planner_cbf.py"  launch-prefix="gnome-terminal --title=cbf_local -x">
    <param name="/obstacle_num"           value="$(arg obstacle_num)"/>
    <param name="/robot_r"           value="$(arg robot_r)"/>
    <param name="/safe_dis_cbf"           value="$(arg safe_dis_cbf)"/>

  </node>
</group>  

<node name="controller" pkg="local_planner" type="controller.py" launch-prefix="gnome-terminal --title=controller -x"/>


 <node launch-prefix="nice" pkg="rviz" type="rviz" name="rvizGA" args="-d $(find simulator)/rviz/simulator.rviz" respawn="true"/>




</launch>
